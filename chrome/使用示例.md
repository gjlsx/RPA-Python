# Chrome自动化套件使用示例

## 🚀 快速开始

### 1. 环境准备
确保已安装Python和必要的依赖包：
```bash
pip install selenium psutil pywin32
```

### 2. 一键启动
双击运行 `start_automation.bat` 或在命令行执行：
```bash
python chrome_automation_suite.py --interactive
```

## 📋 基础操作示例

### 启动Chrome实例
```bash
# 启动Chrome_11到Chrome_15
python chrome_automation_suite.py --launch 11 15

# 查看启动状态
python chrome_automation_suite.py --status
```

### 运行自动化任务
```bash
# 运行示例任务
python chrome_automation_suite.py --batch sample_tasks.json
```

### 关闭Chrome实例
```bash
# 关闭指定实例
python chrome_automation_suite.py --close 11 12 13
```

## 🤖 自动化任务配置

### 创建任务配置文件
创建 `my_tasks.json` 文件：
```json
[
  {
    "task_id": "google_search_python",
    "chrome_num": 11,
    "priority": 1,
    "actions": [
      {
        "type": "navigate",
        "url": "https://www.google.com"
      },
      {
        "type": "input",
        "selectors": ["input[name='q']"],
        "text": "Python自动化"
      },
      {
        "type": "click",
        "selectors": ["input[name='btnK']"]
      }
    ],
    "metadata": {
      "description": "搜索Python自动化",
      "category": "search"
    }
  },
  {
    "task_id": "visit_github",
    "chrome_num": 12,
    "priority": 2,
    "actions": [
      {
        "type": "navigate",
        "url": "https://github.com"
      },
      {
        "type": "wait",
        "seconds": 3
      }
    ],
    "metadata": {
      "description": "访问GitHub",
      "category": "visit"
    }
  }
]
```

### 运行自定义任务
```bash
python chrome_automation_suite.py --batch my_tasks.json
```

## 🎮 交互模式使用

启动交互模式：
```bash
python chrome_automation_suite.py --interactive
```

可用命令：
- `status` - 显示系统状态
- `launch 11 15` - 启动Chrome_11到Chrome_15
- `close 11 12 13` - 关闭指定Chrome实例
- `task sample` - 运行示例任务
- `export` - 导出操作日志
- `cleanup` - 清理旧日志文件
- `help` - 显示帮助
- `quit` - 退出程序

## 📊 监控和日志

### 查看系统状态
```bash
python chrome_automation_suite.py --status
```

输出示例：
```
📊 Chrome自动化套件状态
==================================================
📈 操作统计:
   总操作数: 25
   成功操作: 23
   失败操作: 2
   活跃实例: 3

🖥️  Chrome实例状态:
   Chrome_11: 🟢 running
   Chrome_12: 🟢 running
   Chrome_13: 🔴 error

💻 系统资源:
   CPU使用率: 15.2%
   内存使用率: 68.5%
   Chrome进程数: 6
   Chrome总内存: 1024.5MB
```

### 导出日志
```python
from operation_monitor import get_monitor

monitor = get_monitor()
monitor.export_logs("my_logs.json", hours=24)  # 导出最近24小时的日志
```

## 🔧 高级配置

### 修改配置文件
编辑 `automation_config.json`：
```json
{
  "system": {
    "max_concurrent_tasks": 10,
    "default_timeout": 60,
    "retry_attempts": 5
  },
  "chrome": {
    "startup_delay": 5,
    "page_load_timeout": 45
  }
}
```

### 自定义网站配置
编辑 `websites_config.txt`：
```
https://www.google.com
https://github.com
https://stackoverflow.com
https://www.baidu.com
```

## 🐛 故障排除

### 常见问题

#### 1. Chrome实例无法启动
- 检查Chrome路径是否正确
- 确保端口未被占用
- 检查用户数据目录权限

#### 2. 自动化操作失败
- 检查网络连接
- 确认目标网站可访问
- 检查元素选择器是否正确

#### 3. 内存使用过高
- 减少并发任务数量
- 定期关闭不需要的Chrome实例
- 清理旧的用户数据目录

### 调试模式
```python
# 启用详细日志
from operation_monitor import get_monitor

monitor = get_monitor()
monitor.log_operation(11, "debug", "调试信息", "INFO", {"debug": True})
```

## 📝 最佳实践

### 1. 任务设计
- 将复杂任务分解为简单步骤
- 添加适当的等待时间
- 使用多种选择器策略提高成功率

### 2. 资源管理
- 定期清理不需要的Chrome实例
- 监控系统资源使用情况
- 设置合理的并发任务数量

### 3. 错误处理
- 为关键操作设置重试机制
- 记录详细的错误信息
- 实现优雅的错误恢复

### 4. 性能优化
- 使用任务优先级合理调度
- 避免不必要的页面加载
- 复用已打开的Chrome实例

## 🔗 相关文档

- [README.md](README.md) - 项目总览
- [Chrome快捷方式生成器使用说明.md](Chrome快捷方式生成器使用说明.md) - 快捷方式生成详解
- [automation_config.json](automation_config.json) - 配置文件说明

## 💡 技巧和窍门

### 批量操作技巧
```bash
# 快速启动多个实例并运行任务
python chrome_automation_suite.py --launch 11 20 && python chrome_automation_suite.py --batch sample_tasks.json
```

### 定时任务
可以结合Windows任务计划程序或cron实现定时自动化：
```bash
# 每天上午9点运行自动化任务
# 在任务计划程序中设置：
# 程序: python
# 参数: chrome_automation_suite.py --batch daily_tasks.json
# 起始位置: D:\work\aiwork\rpa\chrome
```

### 监控脚本
创建监控脚本定期检查系统状态：
```python
import time
from chrome_automation_suite import ChromeAutomationSuite

suite = ChromeAutomationSuite()
while True:
    suite.show_status()
    time.sleep(300)  # 每5分钟检查一次
```
